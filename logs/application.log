2025-09-05 16:11:52.982 [main] INFO  c.s.b.service.AccountServiceTest - Starting AccountServiceTest using Java 21 with PID 249477 (started by root in /home/sacred/git/real-time-balance-calculation)
2025-09-05 16:11:53.001 [main] DEBUG c.s.b.service.AccountServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 16:11:53.003 [main] INFO  c.s.b.service.AccountServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 16:11:58.368 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 16:11:58.376 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 16:11:59.060 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 615 ms. Found 2 JPA repository interfaces.
2025-09-05 16:11:59.115 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 16:11:59.120 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 16:11:59.183 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 16:11:59.189 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 16:11:59.190 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 38 ms. Found 0 Redis repository interfaces.
2025-09-05 16:12:04.566 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 16:12:04.817 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 16:12:05.075 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 16:12:06.744 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 16:12:06.907 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 16:12:08.439 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 16:12:08.446 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 16:12:12.017 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 16:12:12.266 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 16:12:16.419 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 16:12:20.895 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 16:12:21.342 [main] INFO  c.s.b.service.AccountServiceTest - Started AccountServiceTest in 30.133 seconds (process running for 35.693)
2025-09-05 16:12:21.416 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 16:12:23.319 [scheduling-1] ERROR c.s.b.s.TransactionRecoveryService - Error during transaction recovery: Unable to connect to Redis
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1805)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1736)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1538)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.lambda$getConnection$0(LettuceConnectionFactory.java:1518)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.doInLock(LettuceConnectionFactory.java:1478)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1515)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1199)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:1006)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:194)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:143)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:104)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:393)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:373)
	at org.springframework.data.redis.core.RedisTemplate.doWithKeys(RedisTemplate.java:785)
	at org.springframework.data.redis.core.RedisTemplate.keys(RedisTemplate.java:638)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:42)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactionsPeriodically(TransactionRecoveryService.java:33)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:499)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:358)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:350)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:215)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:112)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:112)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1734)
	... 28 common frames omitted
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:6379
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:682)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:973)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-05 16:12:26.434 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 16:12:26.454 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 16:12:26.463 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 18:30:46.962 [main] INFO  c.s.b.service.AccountServiceTest - Starting AccountServiceTest using Java 17.0.16 with PID 272210 (started by root in /home/sacred/git/real-time-balance-calculation)
2025-09-05 18:30:46.979 [main] DEBUG c.s.b.service.AccountServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 18:30:46.989 [main] INFO  c.s.b.service.AccountServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 18:30:52.562 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 18:30:52.569 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 18:30:53.258 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 653 ms. Found 2 JPA repository interfaces.
2025-09-05 18:30:53.312 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 18:30:53.318 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 18:30:53.380 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 18:30:53.383 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 18:30:53.385 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 33 ms. Found 0 Redis repository interfaces.
2025-09-05 18:30:58.231 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 18:30:58.506 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 18:30:58.666 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 18:30:59.738 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 18:30:59.882 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 18:31:00.912 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 18:31:00.919 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 18:31:01.141 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 18:31:01.159 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 18:31:04.708 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 18:31:04.959 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 18:31:09.233 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 18:31:14.478 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 18:31:14.881 [main] INFO  c.s.b.service.AccountServiceTest - Started AccountServiceTest in 30.087 seconds (process running for 35.536)
2025-09-05 18:31:14.939 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 18:31:16.887 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 18:31:18.034 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 18:31:18.254 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 18:31:18.594 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 18:31:18.671 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 18:31:18.904 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 18:31:18.936 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 18:31:18.952 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 18:31:18.979 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 18:31:19.018 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 18:31:19.036 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 18:31:19.045 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 18:31:19.054 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 18:31:19.064 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 18:31:19.075 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 18:31:19.104 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 18:31:19.139 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 18:31:19.152 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 18:31:19.180 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 18:31:19.193 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 18:31:19.235 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 18:31:19.400 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 18:31:19.423 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 18:31:19.435 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 18:31:19.442 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 18:31:19.457 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 18:31:19.482 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 18:31:19.495 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 18:31:19.502 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 18:31:19.511 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 18:31:19.521 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 18:31:19.538 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 18:31:19.624 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 18:31:19.632 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 18:31:19.640 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 18:31:19.664 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 18:31:19.673 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 18:31:19.694 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 18:31:19.701 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 18:31:19.711 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 18:31:19.724 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 18:31:19.803 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 18:31:19.922 [pool-6-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 10.0, New Balance: 510.0
2025-09-05 18:31:19.952 [pool-6-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 510.0, Amount: 10.0, New Balance: 520.0
2025-09-05 18:31:19.973 [pool-6-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 18:31:19.982 [pool-6-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 18:31:19.996 [pool-6-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 530.0, Amount: 10.0, New Balance: 540.0
2025-09-05 18:31:20.105 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 18:31:20.198 [pool-7-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1000.0, Amount: 10.0, New Balance: 1010.0
2025-09-05 18:31:20.213 [pool-7-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1010.0, Amount: 10.0, New Balance: 1020.0
2025-09-05 18:31:20.229 [pool-7-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1010.0, Amount: 10.0, New Balance: 1020.0
2025-09-05 18:31:20.243 [pool-7-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1010.0, Amount: 10.0, New Balance: 1020.0
2025-09-05 18:31:20.251 [pool-7-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1020.0, Amount: 10.0, New Balance: 1030.0
2025-09-05 18:31:20.263 [pool-7-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1020.0, Amount: 10.0, New Balance: 1030.0
2025-09-05 18:31:20.271 [pool-7-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1030.0, Amount: 10.0, New Balance: 1040.0
2025-09-05 18:31:20.287 [pool-7-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1030.0, Amount: 10.0, New Balance: 1040.0
2025-09-05 18:31:20.314 [pool-7-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1040.0, Amount: 10.0, New Balance: 1050.0
2025-09-05 18:31:20.322 [pool-7-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1040.0, Amount: 10.0, New Balance: 1050.0
2025-09-05 18:31:20.600 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 18:31:20.662 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 18:31:20.690 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 18:31:20.710 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 18:31:20.723 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 18:31:20.740 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 18:31:20.899 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 18:31:20.919 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 18:31:20.929 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 18:31:21.109 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 18:31:21.124 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 18:31:21.170 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 18:31:21.187 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 18:31:21.194 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: ec972192-ffca-4442-9934-ccb30ae8c788
2025-09-05 18:31:21.351 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 18:31:21.368 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 18:31:21.394 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 18:31:21.408 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 18:31:21.424 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 18:31:21.514 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 18:31:21.543 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 18:31:21.562 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 18:31:21.625 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 18:31:21.643 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 18:31:21.655 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 18:31:21.674 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 18:31:21.784 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 18:31:21.795 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 18:31:21.815 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 18:31:21.834 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 18:31:21.845 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 18:31:22.845 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 18:31:22.863 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 18:31:22.889 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 18:31:22.908 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 18:31:22.914 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 18:31:23.171 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 18:31:23.188 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 18:31:23.211 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 18:31:23.342 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 18:31:23.359 [pool-8-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 18:31:23.373 [pool-8-thread-3] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 18:31:23.375 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 18:31:23.399 [pool-8-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A007
2025-09-05 18:31:23.425 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -200.0, New Balance: 800.0
2025-09-05 18:31:23.437 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: -50.0, New Balance: 450.0
2025-09-05 18:31:23.438 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -100.0, New Balance: 900.0
2025-09-05 18:31:23.457 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 300.0, Amount: 200.0, New Balance: 500.0
2025-09-05 18:31:23.465 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: 50.0, New Balance: 1050.0
2025-09-05 18:31:23.469 [pool-8-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T004
2025-09-05 18:31:23.476 [pool-8-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T005
2025-09-05 18:31:23.493 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 100.0, New Balance: 600.0
2025-09-05 18:31:23.496 [pool-8-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T003
2025-09-05 18:31:23.521 [pool-8-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 40001, SQLState: 40001
2025-09-05 18:31:23.521 [pool-8-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Deadlock detected. The current transaction was rolled back. Details: "ACCOUNTS"; SQL statement:
update accounts set account_number=?,balance=? where id=? [40001-224]
2025-09-05 18:31:23.664 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 18:31:23.684 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 18:31:23.710 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 18:31:23.722 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 18:31:23.731 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 18:31:23.757 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 18:31:23.874 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 18:31:23.887 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 18:31:23.906 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 18:31:23.923 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 18:31:23.928 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 18:31:24.060 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 18:31:24.071 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 18:31:24.092 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 18:31:24.117 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 18:31:24.125 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 18:31:24.155 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 18:31:24.208 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 18:31:24.225 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 18:31:24.231 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 18:31:24.237 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 18:31:24.340 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 18:31:24.355 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 18:31:24.366 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 18:31:24.454 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 18:31:24.513 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 18:31:24.586 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 18:31:24.603 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 18:31:24.605 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 18:31:24.654 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 18:31:24.668 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 18:31:24.673 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 18:31:24.773 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 18:31:24.785 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 18:31:24.795 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 18:31:24.797 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 18:31:24.844 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 18:31:24.855 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 18:31:24.902 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 18:31:24.903 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 18:31:24.951 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 18:31:25.014 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 18:31:25.015 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 18:31:25.330 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 18:31:25.346 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 18:31:25.354 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:23:15.462 [main] INFO  c.s.BalanceCalculationApplication - Starting BalanceCalculationApplication using Java 17.0.16 with PID 52462 (/Users/wengxk/Documents/springboot/real-time-balance-calculation/target/classes started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:23:15.465 [main] INFO  c.s.BalanceCalculationApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:23:16.963 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:23:16.966 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:23:17.351 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 371 ms. Found 2 JPA repository interfaces.
2025-09-05 20:23:17.395 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:23:17.398 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:23:17.461 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:23:17.462 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:23:17.463 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 0 Redis repository interfaces.
2025-09-05 20:23:19.504 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 20:23:19.541 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-09-05 20:23:19.547 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 20:23:19.547 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-09-05 20:23:19.718 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 20:23:19.718 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 4172 ms
2025-09-05 20:23:24.540 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:23:24.785 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:23:24.978 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:23:25.834 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:23:25.917 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:23:27.023 [main] ERROR com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Exception during pool initialization.
org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:61)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:273)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:105)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:66)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:129)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:223)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:191)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:169)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1432)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1503)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 50 common frames omitted
2025-09-05 20:23:27.029 [main] WARN  o.h.e.j.e.i.JdbcEnvironmentInitiator - HHH000342: Could not obtain connection to query metadata
java.lang.NullPointerException: Cannot invoke "org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(java.sql.SQLException, String)" because the return value of "org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.sqlExceptionHelper()" is null
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:116)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:273)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:105)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:66)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:129)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:223)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:191)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:169)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1432)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1503)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
2025-09-05 20:23:27.072 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:23:30.781 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:23:30.845 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:23:32.513 [main] ERROR com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Exception during pool initialization.
org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:46)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:39)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcConnection(ImprovedExtractionContextImpl.java:63)
	at org.hibernate.tool.schema.extract.spi.ExtractionContext.getQueryResults(ExtractionContext.java:43)
	at org.hibernate.tool.schema.extract.internal.SequenceInformationExtractorLegacyImpl.extractMetadata(SequenceInformationExtractorLegacyImpl.java:39)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.initializeSequences(DatabaseInformationImpl.java:66)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.<init>(DatabaseInformationImpl.java:60)
	at org.hibernate.tool.schema.internal.Helper.buildDatabaseInformation(Helper.java:185)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:98)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:286)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:145)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:142)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:295)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:450)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1507)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 54 common frames omitted
2025-09-05 20:23:32.514 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 08001
2025-09-05 20:23:32.515 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - 
2025-09-05 20:23:32.524 [main] ERROR o.s.o.j.LocalContainerEntityManagerFactoryBean - Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
2025-09-05 20:23:32.524 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
2025-09-05 20:23:32.540 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-09-05 20:23:32.562 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-09-05 20:23:32.580 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1775)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: jakarta.persistence.PersistenceException: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:421)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	... 16 common frames omitted
Caused by: org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:100)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:74)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:39)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcConnection(ImprovedExtractionContextImpl.java:63)
	at org.hibernate.tool.schema.extract.spi.ExtractionContext.getQueryResults(ExtractionContext.java:43)
	at org.hibernate.tool.schema.extract.internal.SequenceInformationExtractorLegacyImpl.extractMetadata(SequenceInformationExtractorLegacyImpl.java:39)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.initializeSequences(DatabaseInformationImpl.java:66)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.<init>(DatabaseInformationImpl.java:60)
	at org.hibernate.tool.schema.internal.Helper.buildDatabaseInformation(Helper.java:185)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:98)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:286)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:145)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:142)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:295)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:450)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1507)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	... 20 common frames omitted
Caused by: org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:46)
	... 40 common frames omitted
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 54 common frames omitted
2025-09-05 20:24:14.015 [main] INFO  c.s.BalanceCalculationApplication - Starting BalanceCalculationApplication using Java 17.0.16 with PID 52537 (/Users/wengxk/Documents/springboot/real-time-balance-calculation/target/classes started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:24:14.018 [main] INFO  c.s.BalanceCalculationApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:24:15.942 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:24:15.951 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:24:16.275 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 314 ms. Found 2 JPA repository interfaces.
2025-09-05 20:24:16.293 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:24:16.295 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:24:16.311 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:24:16.312 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:24:16.312 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-09-05 20:24:18.471 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 20:24:18.484 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-09-05 20:24:18.491 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 20:24:18.491 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-09-05 20:24:18.566 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 20:24:18.567 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 4358 ms
2025-09-05 20:24:19.888 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:24:19.955 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:24:19.992 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:24:20.659 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:24:20.760 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:24:21.298 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@271a140c
2025-09-05 20:24:21.300 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:24:21.361 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:24:23.270 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:24:23.456 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Warning Code: 0, SQLState: 00000
2025-09-05 20:24:23.457 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - constraint "idx_account_number" of relation "accounts" does not exist, skipping
2025-09-05 20:24:23.488 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:24:26.254 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 20:24:28.543 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 20:24:28.868 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-09-05 20:24:28.947 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-09-05 20:24:28.982 [main] INFO  c.s.BalanceCalculationApplication - Started BalanceCalculationApplication in 16.434 seconds (process running for 18.685)
2025-09-05 20:24:29.017 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:24:29.853 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 20:24:56.076 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:24:56.080 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 20:24:56.084 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:25:09.980 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 22.0.2 with PID 52626 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:25:09.983 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 20:25:09.985 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:25:20.088 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:25:20.094 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:25:20.671 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 555 ms. Found 2 JPA repository interfaces.
2025-09-05 20:25:20.766 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:25:20.811 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:25:20.881 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:25:20.882 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:25:20.882 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
2025-09-05 20:25:26.968 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:25:27.123 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:25:27.212 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:25:28.475 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:25:28.710 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:25:31.251 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 20:25:31.258 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:25:31.410 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 20:25:31.439 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:25:36.146 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:25:36.290 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:25:42.374 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 20:25:46.772 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 20:25:47.090 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 40.451 seconds (process running for 47.461)
2025-09-05 20:25:47.118 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:25:49.064 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 20:25:49.617 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 20:25:49.834 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 20:25:50.034 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 20:25:50.070 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 20:25:50.237 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 20:25:50.369 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:25:50.669 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 20:25:50.674 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 20:25:50.824 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 20:25:50.868 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 20:25:50.899 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 20:25:50.900 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 20:25:51.045 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2108)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:2010)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 20:25:51.051 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 20:25:51.121 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 20:25:51.122 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 20:25:51.174 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 20:25:51.316 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 20:25:51.316 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 20:25:53.312 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 20:25:53.762 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 20:25:54.433 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 20:25:54.523 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 20:25:54.835 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 20:25:54.855 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 20:25:54.871 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 20:25:54.885 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 20:25:54.901 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 20:25:54.914 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 20:25:54.928 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 20:25:54.951 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 20:25:54.966 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 20:25:54.986 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 20:25:55.003 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 20:25:55.017 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 20:25:55.034 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 20:25:55.051 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 20:25:55.066 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 260.0, Amount: 5.0, New Balance: 265.0
2025-09-05 20:25:55.128 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 20:25:55.212 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 20:25:55.224 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 20:25:55.233 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 20:25:55.242 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 20:25:55.251 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 20:25:55.261 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 20:25:55.270 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 20:25:55.297 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 20:25:55.312 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 20:25:55.325 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 20:25:55.362 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 20:25:55.377 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 20:25:55.384 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 20:25:55.391 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 20:25:55.399 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 20:25:55.408 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 20:25:55.420 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 20:25:55.433 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 20:25:55.440 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 20:25:55.449 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1017.0, Amount: 1.0, New Balance: 1018.0
2025-09-05 20:25:55.503 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:25:55.634 [pool-6-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 10.0, New Balance: 510.0
2025-09-05 20:25:55.658 [pool-6-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 510.0, Amount: 10.0, New Balance: 520.0
2025-09-05 20:25:55.683 [pool-6-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 20:25:55.693 [pool-6-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 530.0, Amount: 10.0, New Balance: 540.0
2025-09-05 20:25:55.708 [pool-6-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 540.0, Amount: 10.0, New Balance: 550.0
2025-09-05 20:25:55.797 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 20:25:55.918 [pool-7-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1000.0, Amount: 10.0, New Balance: 1010.0
2025-09-05 20:25:55.927 [pool-7-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1010.0, Amount: 10.0, New Balance: 1020.0
2025-09-05 20:25:55.939 [pool-7-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1020.0, Amount: 10.0, New Balance: 1030.0
2025-09-05 20:25:55.950 [pool-7-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1030.0, Amount: 10.0, New Balance: 1040.0
2025-09-05 20:25:55.963 [pool-7-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1030.0, Amount: 10.0, New Balance: 1040.0
2025-09-05 20:25:55.974 [pool-7-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1040.0, Amount: 10.0, New Balance: 1050.0
2025-09-05 20:25:55.987 [pool-7-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1050.0, Amount: 10.0, New Balance: 1060.0
2025-09-05 20:25:55.995 [pool-7-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1060.0, Amount: 10.0, New Balance: 1070.0
2025-09-05 20:25:56.002 [pool-7-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1070.0, Amount: 10.0, New Balance: 1080.0
2025-09-05 20:25:56.011 [pool-7-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1080.0, Amount: 10.0, New Balance: 1090.0
2025-09-05 20:25:56.118 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 20:25:56.143 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 20:25:56.156 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 20:25:56.180 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 20:25:56.195 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 20:25:56.204 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 20:25:56.318 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:25:56.333 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:25:56.345 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 20:25:56.446 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 20:25:56.461 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 20:25:56.482 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 20:25:56.498 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 20:25:56.501 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: d4e9c254-3d7c-4b2e-a49e-25b7cc1fef03
2025-09-05 20:25:56.634 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 20:25:56.649 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 20:25:56.670 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 20:25:56.683 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 20:25:56.689 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 20:25:56.746 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 20:25:56.757 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 20:25:56.766 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 20:25:56.842 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 20:25:56.852 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 20:25:56.859 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 20:25:56.877 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 20:25:56.985 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:25:57.000 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:25:57.019 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 20:25:57.033 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 20:25:57.036 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 20:25:58.508 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 20:25:58.538 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 20:25:58.560 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 20:25:58.576 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 20:25:58.579 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 20:25:58.897 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:25:58.928 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:25:58.940 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 20:25:59.046 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 20:25:59.074 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 20:25:59.100 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -100.0, New Balance: 900.0
2025-09-05 20:25:59.118 [pool-8-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A007
2025-09-05 20:25:59.142 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 100.0, New Balance: 600.0
2025-09-05 20:25:59.144 [pool-8-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T003
2025-09-05 20:25:59.150 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -200.0, New Balance: 800.0
2025-09-05 20:25:59.150 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: -50.0, New Balance: 450.0
2025-09-05 20:25:59.167 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: 50.0, New Balance: 1050.0
2025-09-05 20:25:59.171 [pool-8-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T005
2025-09-05 20:25:59.228 [pool-8-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 40001, SQLState: 40001
2025-09-05 20:25:59.230 [pool-8-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Deadlock detected. The current transaction was rolled back. Details: "ACCOUNTS"; SQL statement:
update accounts set account_number=?,balance=? where id=? [40001-224]
2025-09-05 20:25:59.245 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 300.0, Amount: 200.0, New Balance: 500.0
2025-09-05 20:25:59.249 [pool-8-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T004
2025-09-05 20:25:59.391 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 20:25:59.404 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 20:25:59.437 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 20:25:59.450 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 20:25:59.456 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 20:25:59.497 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 20:25:59.619 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 20:25:59.639 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 20:25:59.670 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 20:25:59.679 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 20:25:59.681 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 20:25:59.804 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 20:25:59.818 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 20:25:59.852 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 20:25:59.867 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 20:25:59.873 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 20:25:59.920 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 20:25:59.982 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 20:25:59.993 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 20:25:59.998 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 20:26:00.022 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 20:26:00.132 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:26:00.161 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:26:00.173 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 20:26:01.010 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:26:01.026 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 20:26:01.031 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:46:39.589 [main] INFO  c.s.BalanceCalculationApplication - Starting BalanceCalculationApplication using Java 17.0.16 with PID 54201 (/Users/wengxk/Documents/springboot/real-time-balance-calculation/target/classes started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:46:39.605 [main] INFO  c.s.BalanceCalculationApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:46:41.630 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:46:41.632 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:46:42.097 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 458 ms. Found 2 JPA repository interfaces.
2025-09-05 20:46:42.134 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:46:42.136 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:46:42.155 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:46:42.155 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:46:42.155 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-09-05 20:46:43.611 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 20:46:43.647 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-09-05 20:46:43.650 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 20:46:43.650 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-09-05 20:46:43.775 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 20:46:43.776 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3742 ms
2025-09-05 20:46:45.197 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:46:45.280 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:46:45.322 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:46:45.683 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:46:45.733 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:46:47.498 [main] ERROR com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Exception during pool initialization.
org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:61)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:273)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:105)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:66)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:129)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:223)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:191)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:169)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1432)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1503)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 50 common frames omitted
2025-09-05 20:46:47.509 [main] WARN  o.h.e.j.e.i.JdbcEnvironmentInitiator - HHH000342: Could not obtain connection to query metadata
java.lang.NullPointerException: Cannot invoke "org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(java.sql.SQLException, String)" because the return value of "org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.sqlExceptionHelper()" is null
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:116)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:273)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:105)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:66)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:129)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:223)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:191)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:169)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1432)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1503)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
2025-09-05 20:46:47.569 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:46:49.531 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:46:49.550 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:46:53.833 [main] ERROR com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Exception during pool initialization.
org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:46)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:39)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcConnection(ImprovedExtractionContextImpl.java:63)
	at org.hibernate.tool.schema.extract.spi.ExtractionContext.getQueryResults(ExtractionContext.java:43)
	at org.hibernate.tool.schema.extract.internal.SequenceInformationExtractorLegacyImpl.extractMetadata(SequenceInformationExtractorLegacyImpl.java:39)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.initializeSequences(DatabaseInformationImpl.java:66)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.<init>(DatabaseInformationImpl.java:60)
	at org.hibernate.tool.schema.internal.Helper.buildDatabaseInformation(Helper.java:185)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:98)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:286)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:145)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:142)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:295)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:450)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1507)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 54 common frames omitted
2025-09-05 20:46:53.836 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 08001
2025-09-05 20:46:53.836 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - 
2025-09-05 20:46:53.849 [main] ERROR o.s.o.j.LocalContainerEntityManagerFactoryBean - Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
2025-09-05 20:46:53.850 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
2025-09-05 20:46:53.866 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-09-05 20:46:53.886 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-09-05 20:46:53.901 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1775)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: jakarta.persistence.PersistenceException: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:421)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	... 16 common frames omitted
Caused by: org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:100)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:74)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:39)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcConnection(ImprovedExtractionContextImpl.java:63)
	at org.hibernate.tool.schema.extract.spi.ExtractionContext.getQueryResults(ExtractionContext.java:43)
	at org.hibernate.tool.schema.extract.internal.SequenceInformationExtractorLegacyImpl.extractMetadata(SequenceInformationExtractorLegacyImpl.java:39)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.initializeSequences(DatabaseInformationImpl.java:66)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.<init>(DatabaseInformationImpl.java:60)
	at org.hibernate.tool.schema.internal.Helper.buildDatabaseInformation(Helper.java:185)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:98)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:286)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:145)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:142)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:295)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:450)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1507)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	... 20 common frames omitted
Caused by: org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:46)
	... 40 common frames omitted
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 54 common frames omitted
2025-09-05 20:47:56.153 [main] INFO  c.s.BalanceCalculationApplication - Starting BalanceCalculationApplication using Java 17.0.16 with PID 54284 (/Users/wengxk/Documents/springboot/real-time-balance-calculation/target/classes started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:47:56.155 [main] INFO  c.s.BalanceCalculationApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:47:57.640 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:47:57.642 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:47:57.796 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 145 ms. Found 2 JPA repository interfaces.
2025-09-05 20:47:57.809 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:47:57.811 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:47:57.824 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:47:57.825 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:47:57.825 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-09-05 20:47:58.819 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 20:47:58.827 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-09-05 20:47:58.830 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 20:47:58.830 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-09-05 20:47:58.901 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 20:47:58.903 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2521 ms
2025-09-05 20:47:59.723 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:47:59.771 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:47:59.803 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:48:00.064 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:48:00.088 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:48:01.163 [main] ERROR com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Exception during pool initialization.
org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:61)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:273)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:105)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:66)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:129)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:223)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:191)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:169)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1432)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1503)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 50 common frames omitted
2025-09-05 20:48:01.168 [main] WARN  o.h.e.j.e.i.JdbcEnvironmentInitiator - HHH000342: Could not obtain connection to query metadata
java.lang.NullPointerException: Cannot invoke "org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(java.sql.SQLException, String)" because the return value of "org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.sqlExceptionHelper()" is null
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:116)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:273)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:105)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:66)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:129)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:223)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:191)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:169)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1432)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1503)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
2025-09-05 20:48:01.186 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:48:02.006 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:48:02.024 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:48:03.092 [main] ERROR com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Exception during pool initialization.
org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:46)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:39)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcConnection(ImprovedExtractionContextImpl.java:63)
	at org.hibernate.tool.schema.extract.spi.ExtractionContext.getQueryResults(ExtractionContext.java:43)
	at org.hibernate.tool.schema.extract.internal.SequenceInformationExtractorLegacyImpl.extractMetadata(SequenceInformationExtractorLegacyImpl.java:39)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.initializeSequences(DatabaseInformationImpl.java:66)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.<init>(DatabaseInformationImpl.java:60)
	at org.hibernate.tool.schema.internal.Helper.buildDatabaseInformation(Helper.java:185)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:98)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:286)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:145)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:142)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:295)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:450)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1507)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 54 common frames omitted
2025-09-05 20:48:03.096 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 08001
2025-09-05 20:48:03.096 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - 
2025-09-05 20:48:03.119 [main] ERROR o.s.o.j.LocalContainerEntityManagerFactoryBean - Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
2025-09-05 20:48:03.120 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
2025-09-05 20:48:03.141 [main] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-09-05 20:48:03.168 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-09-05 20:48:03.184 [main] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1775)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1173)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:936)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331)
	at com.sacred.BalanceCalculationApplication.main(BalanceCalculationApplication.java:18)
Caused by: jakarta.persistence.PersistenceException: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:421)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1771)
	... 16 common frames omitted
Caused by: org.hibernate.exception.JDBCConnectionException: Unable to open JDBC Connection for DDL execution [] [n/a]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:100)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:74)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:39)
	at org.hibernate.tool.schema.internal.exec.ImprovedExtractionContextImpl.getJdbcConnection(ImprovedExtractionContextImpl.java:63)
	at org.hibernate.tool.schema.extract.spi.ExtractionContext.getQueryResults(ExtractionContext.java:43)
	at org.hibernate.tool.schema.extract.internal.SequenceInformationExtractorLegacyImpl.extractMetadata(SequenceInformationExtractorLegacyImpl.java:39)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.initializeSequences(DatabaseInformationImpl.java:66)
	at org.hibernate.tool.schema.extract.internal.DatabaseInformationImpl.<init>(DatabaseInformationImpl.java:60)
	at org.hibernate.tool.schema.internal.Helper.buildDatabaseInformation(Helper.java:185)
	at org.hibernate.tool.schema.internal.AbstractSchemaMigrator.doMigration(AbstractSchemaMigrator.java:98)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:286)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:145)
	at java.base/java.util.HashMap.forEach(HashMap.java:1421)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:142)
	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)
	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:295)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:450)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1507)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:376)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)
	... 20 common frames omitted
Caused by: org.postgresql.util.PSQLException: 
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:354)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:263)
	at org.postgresql.Driver.makeConnection(Driver.java:443)
	at org.postgresql.Driver.connect(Driver.java:297)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:122)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:424)
	at org.hibernate.resource.transaction.backend.jdbc.internal.DdlTransactionIsolatorNonJtaImpl.getIsolatedConnection(DdlTransactionIsolatorNonJtaImpl.java:46)
	... 40 common frames omitted
Caused by: java.io.EOFException: null
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:589)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:191)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:258)
	... 54 common frames omitted
2025-09-05 20:51:11.164 [main] INFO  c.s.BalanceCalculationApplication - Starting BalanceCalculationApplication using Java 17.0.16 with PID 54498 (/Users/wengxk/Documents/springboot/real-time-balance-calculation/target/classes started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:51:11.167 [main] INFO  c.s.BalanceCalculationApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:51:12.747 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:51:12.749 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:51:13.010 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 253 ms. Found 2 JPA repository interfaces.
2025-09-05 20:51:13.023 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:51:13.026 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:51:13.045 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:51:13.046 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:51:13.046 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-09-05 20:51:14.450 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 20:51:14.458 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-09-05 20:51:14.461 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 20:51:14.461 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-09-05 20:51:14.516 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 20:51:14.516 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3137 ms
2025-09-05 20:51:15.402 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:51:15.479 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:51:15.517 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:51:15.783 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:51:15.806 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:51:15.968 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@105fe81e
2025-09-05 20:51:15.969 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:51:16.098 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:51:17.168 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:51:17.248 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:51:18.507 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 20:51:20.020 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 20:51:20.135 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-09-05 20:51:20.151 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path ''
2025-09-05 20:51:20.171 [main] INFO  c.s.BalanceCalculationApplication - Started BalanceCalculationApplication in 9.834 seconds (process running for 11.597)
2025-09-05 20:51:20.180 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:51:20.541 [RMI TCP Connection(2)-127.0.0.1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-05 20:51:20.542 [RMI TCP Connection(2)-127.0.0.1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-05 20:51:20.547 [RMI TCP Connection(2)-127.0.0.1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 5 ms
2025-09-05 20:51:20.875 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 20:53:20.176 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:53:20.181 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 20:53:37.138 [lettuce-eventExecutorLoop-1-1] INFO  i.l.core.protocol.ConnectionWatchdog - Reconnecting, last destination was localhost/127.0.0.1:6379
2025-09-05 20:53:37.139 [lettuce-eventExecutorLoop-1-4] INFO  i.l.core.protocol.ConnectionWatchdog - Reconnecting, last destination was localhost/127.0.0.1:6379
2025-09-05 20:53:37.249 [lettuce-nioEventLoop-4-4] WARN  i.l.core.protocol.ConnectionWatchdog - Cannot reconnect to [localhost/<unresolved>:6379]: Connection closed prematurely
io.lettuce.core.RedisConnectionException: Connection closed prematurely
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:91)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:566)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-09-05 20:53:37.264 [lettuce-nioEventLoop-4-3] WARN  i.l.core.protocol.ConnectionWatchdog - Cannot reconnect to [localhost/<unresolved>:6379]: Connection closed prematurely
io.lettuce.core.RedisConnectionException: Connection closed prematurely
	at io.lettuce.core.protocol.RedisHandshakeHandler.channelInactive(RedisHandshakeHandler.java:91)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.lettuce.core.ChannelGroupListener.channelInactive(ChannelGroupListener.java:69)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:305)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:274)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:301)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:281)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:566)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-09-05 20:53:39.652 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:53:39.666 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 20:53:39.671 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:53:54.428 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 22.0.2 with PID 54704 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:53:54.431 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 20:53:54.433 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:54:01.806 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:54:01.812 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:54:02.279 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 447 ms. Found 2 JPA repository interfaces.
2025-09-05 20:54:02.331 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:54:02.333 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:54:02.378 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:54:02.379 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:54:02.379 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
2025-09-05 20:54:07.436 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:54:07.763 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:54:07.898 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:54:09.340 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:54:09.431 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:54:12.204 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 20:54:12.208 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:54:12.285 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 20:54:12.298 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:54:16.207 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:54:16.361 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:54:20.711 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 20:54:28.405 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 20:54:28.785 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 37.162 seconds (process running for 43.497)
2025-09-05 20:54:28.801 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:54:31.328 [scheduling-1] ERROR c.s.b.s.TransactionRecoveryService - Error during transaction recovery: Unable to connect to Redis
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1805)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1736)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1538)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.lambda$getConnection$0(LettuceConnectionFactory.java:1518)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.doInLock(LettuceConnectionFactory.java:1478)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1515)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1199)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:1006)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:194)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:143)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:104)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:393)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:373)
	at org.springframework.data.redis.core.RedisTemplate.doWithKeys(RedisTemplate.java:785)
	at org.springframework.data.redis.core.RedisTemplate.keys(RedisTemplate.java:638)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:42)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactionsPeriodically(TransactionRecoveryService.java:33)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:499)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:358)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:350)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:215)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:112)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:112)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1734)
	... 28 common frames omitted
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:6379
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:682)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:1060)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-09-05 20:54:39.261 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:54:39.295 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 20:54:39.306 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:54:58.408 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 22.0.2 with PID 54875 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:54:58.471 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 20:54:58.473 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:55:08.945 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:55:08.949 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:55:10.021 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1023 ms. Found 2 JPA repository interfaces.
2025-09-05 20:55:10.142 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:55:10.146 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:55:10.268 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:55:10.269 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:55:10.269 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 40 ms. Found 0 Redis repository interfaces.
2025-09-05 20:55:19.298 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:55:19.599 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:55:19.768 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:55:21.504 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:55:21.873 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:55:25.942 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 20:55:25.950 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:55:26.353 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 20:55:26.396 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:55:32.418 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:55:32.584 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:55:37.616 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 20:55:43.027 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 20:55:43.520 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 48.973 seconds (process running for 62.568)
2025-09-05 20:55:43.543 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:55:44.939 [scheduling-1] ERROR c.s.b.s.TransactionRecoveryService - Error during transaction recovery: Unable to connect to Redis
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1805)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1736)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1538)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.lambda$getConnection$0(LettuceConnectionFactory.java:1518)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.doInLock(LettuceConnectionFactory.java:1478)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1515)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1199)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:1006)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:194)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:143)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:104)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:393)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:373)
	at org.springframework.data.redis.core.RedisTemplate.doWithKeys(RedisTemplate.java:785)
	at org.springframework.data.redis.core.RedisTemplate.keys(RedisTemplate.java:638)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:42)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactionsPeriodically(TransactionRecoveryService.java:33)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:499)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:358)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:350)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:215)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:112)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:112)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1734)
	... 28 common frames omitted
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:6379
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:682)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:1060)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-09-05 20:55:48.840 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:55:48.853 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 20:55:48.859 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:56:01.467 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 22.0.2 with PID 55052 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:56:01.487 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 20:56:01.488 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:56:08.783 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:56:08.793 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:56:09.398 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 553 ms. Found 2 JPA repository interfaces.
2025-09-05 20:56:09.439 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:56:09.442 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:56:09.504 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:56:09.505 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:56:09.505 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 38 ms. Found 0 Redis repository interfaces.
2025-09-05 20:56:17.378 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:56:17.736 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:56:17.832 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:56:19.813 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:56:20.234 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:56:22.014 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 20:56:22.020 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:56:22.134 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 20:56:22.151 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:56:26.401 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:56:26.525 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:56:31.207 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 20:56:39.165 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 20:56:39.722 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 41.676 seconds (process running for 46.487)
2025-09-05 20:56:39.732 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:56:41.724 [scheduling-1] ERROR c.s.b.s.TransactionRecoveryService - Error during transaction recovery: Unable to connect to Redis
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1805)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1736)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1538)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.lambda$getConnection$0(LettuceConnectionFactory.java:1518)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.doInLock(LettuceConnectionFactory.java:1478)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1515)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1199)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:1006)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:194)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:143)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:104)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:393)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:373)
	at org.springframework.data.redis.core.RedisTemplate.doWithKeys(RedisTemplate.java:785)
	at org.springframework.data.redis.core.RedisTemplate.keys(RedisTemplate.java:638)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:42)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactionsPeriodically(TransactionRecoveryService.java:33)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:499)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:358)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:350)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:215)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:112)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:112)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1734)
	... 28 common frames omitted
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:6379
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:682)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:1060)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-09-05 20:56:41.896 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:56:41.921 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 20:56:41.926 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:57:56.795 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 55306 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:57:56.803 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 20:57:56.807 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:58:01.535 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:58:01.538 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:58:02.336 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 773 ms. Found 2 JPA repository interfaces.
2025-09-05 20:58:02.374 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:58:02.382 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:58:02.423 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:58:02.423 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:58:02.426 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 22 ms. Found 0 Redis repository interfaces.
2025-09-05 20:58:06.604 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:58:06.813 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:58:06.903 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:58:07.599 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:58:07.673 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:58:08.849 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 20:58:08.852 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:58:09.022 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 20:58:09.038 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 20:58:12.262 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 20:58:12.490 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:58:16.277 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 20:58:21.371 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 20:58:21.803 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 26.774 seconds (process running for 34.305)
2025-09-05 20:58:21.830 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:58:23.212 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: T001
2025-09-05 20:58:23.212 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 20:58:23.355 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 20:58:23.453 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 20:58:23.588 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 20:58:23.626 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 20:58:23.629 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 20:58:23.706 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 20:58:23.733 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 20:58:23.733 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 20:58:23.909 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 20:58:23.930 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 20:58:23.967 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 20:58:23.967 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 20:58:24.052 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 20:58:24.058 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 20:58:24.126 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 20:58:24.126 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 20:58:24.165 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 20:58:24.349 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 20:58:24.350 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 20:58:25.181 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 20:58:25.267 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 20:58:25.533 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 20:58:25.584 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 20:58:25.833 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 20:58:25.883 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 20:58:25.911 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 20:58:25.931 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 20:58:25.945 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 20:58:25.959 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 20:58:25.973 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 20:58:25.994 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 20:58:26.009 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 20:58:26.019 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 20:58:26.037 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 20:58:26.084 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 20:58:26.115 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 20:58:26.151 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 20:58:26.168 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 20:58:26.230 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 20:58:26.282 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 20:58:26.293 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 20:58:26.301 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 20:58:26.312 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 20:58:26.324 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 20:58:26.350 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 20:58:26.384 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 20:58:26.409 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 20:58:26.431 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 20:58:26.448 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 20:58:26.458 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 20:58:26.466 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 20:58:26.475 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 20:58:26.483 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 20:58:26.492 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 20:58:26.500 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 20:58:26.509 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 20:58:26.517 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 20:58:26.535 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 20:58:26.565 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 20:58:26.684 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:58:26.748 [pool-6-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 10.0, New Balance: 510.0
2025-09-05 20:58:26.767 [pool-6-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 510.0, Amount: 10.0, New Balance: 520.0
2025-09-05 20:58:26.800 [pool-6-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 20:58:26.830 [pool-6-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 20:58:26.864 [pool-6-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 530.0, Amount: 10.0, New Balance: 540.0
2025-09-05 20:58:26.927 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 20:58:27.077 [pool-7-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1000.0, Amount: 10.0, New Balance: 1010.0
2025-09-05 20:58:27.085 [pool-7-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1010.0, Amount: 10.0, New Balance: 1020.0
2025-09-05 20:58:27.099 [pool-7-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1020.0, Amount: 10.0, New Balance: 1030.0
2025-09-05 20:58:27.108 [pool-7-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1030.0, Amount: 10.0, New Balance: 1040.0
2025-09-05 20:58:27.120 [pool-7-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1040.0, Amount: 10.0, New Balance: 1050.0
2025-09-05 20:58:27.129 [pool-7-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1050.0, Amount: 10.0, New Balance: 1060.0
2025-09-05 20:58:27.142 [pool-7-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1060.0, Amount: 10.0, New Balance: 1070.0
2025-09-05 20:58:27.182 [pool-7-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1060.0, Amount: 10.0, New Balance: 1070.0
2025-09-05 20:58:27.231 [pool-7-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1070.0, Amount: 10.0, New Balance: 1080.0
2025-09-05 20:58:27.267 [pool-7-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1080.0, Amount: 10.0, New Balance: 1090.0
2025-09-05 20:58:27.419 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 20:58:27.496 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 20:58:27.523 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 20:58:27.547 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 20:58:27.558 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 20:58:27.564 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 20:58:27.658 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:58:27.716 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:58:27.751 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 20:58:27.873 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 20:58:27.935 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 20:58:28.008 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 20:58:28.022 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 20:58:28.026 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: 578c3ce1-3f64-43fa-98e6-54de86cd5afd
2025-09-05 20:58:28.131 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 20:58:28.144 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 20:58:28.167 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 20:58:28.247 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 20:58:28.296 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 20:58:28.355 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 20:58:28.363 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 20:58:28.369 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 20:58:28.532 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 20:58:28.545 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 20:58:28.550 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 20:58:28.563 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 20:58:28.758 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:58:28.781 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:58:28.813 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 20:58:28.844 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 20:58:28.847 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 20:58:29.928 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 20:58:29.941 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 20:58:29.961 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 20:58:29.977 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 20:58:29.980 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 20:58:30.304 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:58:30.430 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:58:30.451 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 20:58:30.647 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 20:58:30.652 [pool-8-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 20:58:30.682 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 20:58:30.684 [pool-8-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A007
2025-09-05 20:58:30.699 [pool-8-thread-3] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 20:58:30.731 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -100.0, New Balance: 900.0
2025-09-05 20:58:30.743 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -200.0, New Balance: 800.0
2025-09-05 20:58:30.748 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 100.0, New Balance: 600.0
2025-09-05 20:58:30.758 [pool-8-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T003
2025-09-05 20:58:30.769 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: -50.0, New Balance: 450.0
2025-09-05 20:58:30.854 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: 50.0, New Balance: 1050.0
2025-09-05 20:58:30.862 [pool-8-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T005
2025-09-05 20:58:30.911 [pool-8-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 40001, SQLState: 40001
2025-09-05 20:58:30.911 [pool-8-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Deadlock detected. The current transaction was rolled back. Details: "ACCOUNTS"; SQL statement:
update accounts set account_number=?,balance=? where id=? [40001-224]
2025-09-05 20:58:30.969 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 300.0, Amount: 200.0, New Balance: 500.0
2025-09-05 20:58:30.973 [pool-8-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T004
2025-09-05 20:58:31.092 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 20:58:31.102 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 20:58:31.126 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 20:58:31.142 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 20:58:31.144 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 20:58:31.169 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 20:58:31.296 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 20:58:31.350 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 20:58:31.386 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 20:58:31.400 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 20:58:31.402 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 20:58:31.483 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 20:58:31.513 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 20:58:31.603 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 20:58:31.628 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 20:58:31.636 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 20:58:31.693 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 20:58:31.740 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 20:58:31.748 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 20:58:31.754 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 20:58:31.767 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 20:58:31.965 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 20:58:31.980 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 20:58:31.988 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 20:58:33.146 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 20:58:33.160 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 20:58:33.164 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 20:59:45.799 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 55409 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 20:59:45.802 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 20:59:45.805 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 20:59:49.931 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:59:49.934 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 20:59:50.476 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 512 ms. Found 2 JPA repository interfaces.
2025-09-05 20:59:50.530 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 20:59:50.534 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 20:59:50.573 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:59:50.574 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 20:59:50.574 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
2025-09-05 20:59:55.890 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 20:59:56.109 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 20:59:56.250 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 20:59:57.173 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 20:59:57.257 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 20:59:58.221 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 20:59:58.225 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 20:59:58.339 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 20:59:58.359 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:00:01.121 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:00:01.672 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:00:06.572 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:00:12.415 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:00:13.229 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 29.438 seconds (process running for 35.166)
2025-09-05 21:00:13.247 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:00:15.386 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:00:15.537 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:00:15.698 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:00:15.824 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 21:00:15.872 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 21:00:15.880 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 21:00:15.986 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:00:16.030 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 21:00:16.030 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:00:16.218 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 21:00:16.238 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:00:16.276 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 21:00:16.276 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 21:00:16.363 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 21:00:16.367 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:00:16.448 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 21:00:16.448 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:00:16.487 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:00:16.683 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:00:16.683 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:00:17.415 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 21:00:17.632 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 21:00:17.923 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:00:17.983 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 21:00:18.206 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:00:18.218 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:00:18.231 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 21:00:18.244 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:00:18.254 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:00:18.267 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:00:18.300 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:00:18.332 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 21:00:18.371 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:00:18.390 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:00:18.406 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:00:18.417 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:00:18.426 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:00:18.435 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 21:00:18.446 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 21:00:18.606 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 21:00:18.678 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:00:18.686 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:00:18.697 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:00:18.704 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:00:18.714 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:00:18.721 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:00:18.731 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 21:00:18.744 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 21:00:18.756 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:00:18.767 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:00:18.840 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 21:00:18.850 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 21:00:18.871 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:00:18.889 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:00:18.907 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:00:18.934 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:00:18.963 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:00:18.984 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:00:18.997 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 21:00:19.015 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 21:00:19.057 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:00:19.160 [pool-6-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 10.0, New Balance: 510.0
2025-09-05 21:00:19.186 [pool-6-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 510.0, Amount: 10.0, New Balance: 520.0
2025-09-05 21:00:19.216 [pool-6-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 21:00:19.228 [pool-6-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 530.0, Amount: 10.0, New Balance: 540.0
2025-09-05 21:00:19.236 [pool-6-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 540.0, Amount: 10.0, New Balance: 550.0
2025-09-05 21:00:19.274 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:00:19.447 [pool-7-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1000.0, Amount: 10.0, New Balance: 1010.0
2025-09-05 21:00:19.459 [pool-7-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1010.0, Amount: 10.0, New Balance: 1020.0
2025-09-05 21:00:19.469 [pool-7-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1020.0, Amount: 10.0, New Balance: 1030.0
2025-09-05 21:00:19.479 [pool-7-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1030.0, Amount: 10.0, New Balance: 1040.0
2025-09-05 21:00:19.489 [pool-7-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1040.0, Amount: 10.0, New Balance: 1050.0
2025-09-05 21:00:19.507 [pool-7-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1040.0, Amount: 10.0, New Balance: 1050.0
2025-09-05 21:00:19.536 [pool-7-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1050.0, Amount: 10.0, New Balance: 1060.0
2025-09-05 21:00:19.564 [pool-7-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1050.0, Amount: 10.0, New Balance: 1060.0
2025-09-05 21:00:19.587 [pool-7-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1060.0, Amount: 10.0, New Balance: 1070.0
2025-09-05 21:00:19.611 [pool-7-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 1070.0, Amount: 10.0, New Balance: 1080.0
2025-09-05 21:00:19.885 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:00:19.922 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:00:19.943 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:00:19.969 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:00:19.985 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:00:20.006 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:00:20.235 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:00:20.252 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:00:20.263 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:00:20.463 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:00:20.473 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:00:20.491 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:00:20.501 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:00:20.504 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: 8e42d72e-8a41-4ec6-a821-30f21bf4dd04
2025-09-05 21:00:20.715 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:00:20.748 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:00:20.805 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:00:20.855 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:00:20.865 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:00:20.908 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:00:20.918 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:00:20.924 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:00:20.983 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:00:20.996 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:00:21.001 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:00:21.014 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:00:21.164 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:00:21.173 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:00:21.188 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:00:21.197 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:00:21.199 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:00:22.007 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:00:22.019 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:00:22.052 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:00:22.064 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:00:22.066 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:00:22.351 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:00:22.383 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:00:22.392 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:00:22.541 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:00:22.602 [pool-8-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 21:00:22.614 [pool-8-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A007
2025-09-05 21:00:22.631 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -100.0, New Balance: 900.0
2025-09-05 21:00:22.633 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: -50.0, New Balance: 450.0
2025-09-05 21:00:22.644 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -200.0, New Balance: 800.0
2025-09-05 21:00:22.650 [pool-8-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 100.0, New Balance: 600.0
2025-09-05 21:00:22.652 [pool-8-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T003
2025-09-05 21:00:22.659 [pool-8-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: 50.0, New Balance: 1050.0
2025-09-05 21:00:22.662 [pool-8-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T005
2025-09-05 21:00:22.773 [pool-8-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 40001, SQLState: 40001
2025-09-05 21:00:22.774 [pool-8-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Deadlock detected. The current transaction was rolled back. Details: "ACCOUNTS"; SQL statement:
update accounts set account_number=?,balance=? where id=? [40001-224]
2025-09-05 21:00:22.814 [pool-8-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 300.0, Amount: 200.0, New Balance: 500.0
2025-09-05 21:00:22.817 [pool-8-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T004
2025-09-05 21:00:23.007 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:00:23.035 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:00:23.052 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:00:23.066 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:00:23.069 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:00:23.102 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:00:23.196 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:00:23.217 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:00:23.250 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:00:23.265 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:00:23.272 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:00:23.382 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:00:23.414 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:00:23.449 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:00:23.489 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:00:23.519 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:00:23.617 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:00:23.721 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:00:23.734 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:00:23.740 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:00:23.766 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:00:23.975 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:00:24.008 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:00:24.018 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:00:25.204 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:00:25.214 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:00:25.217 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:01:54.954 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 55564 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:01:54.983 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:01:54.985 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:02:03.609 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:02:03.617 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:02:04.302 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 652 ms. Found 2 JPA repository interfaces.
2025-09-05 21:02:04.348 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:02:04.351 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:02:04.390 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:02:04.391 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:02:04.391 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-05 21:02:09.270 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:02:09.576 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:02:09.735 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:02:10.717 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:02:10.801 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:02:11.807 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:02:11.810 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:02:11.941 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:02:11.960 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:02:14.581 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:02:14.712 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:02:19.240 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:02:23.159 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:02:23.542 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 31.181 seconds (process running for 38.258)
2025-09-05 21:02:23.561 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:02:25.270 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:02:25.850 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:02:25.951 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:02:26.028 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 21:02:26.066 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 21:02:26.071 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 21:02:26.165 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:02:26.202 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 21:02:26.202 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:02:26.312 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 21:02:26.330 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:02:26.791 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 21:02:26.792 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 21:02:26.883 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 21:02:26.888 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:02:26.943 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 21:02:26.944 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:02:26.993 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:02:27.163 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:02:27.163 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:02:28.020 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 21:02:28.167 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 21:02:28.511 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:02:28.564 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 21:02:28.785 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:02:28.809 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:02:28.824 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 21:02:28.835 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:02:28.849 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:02:28.898 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:02:28.944 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 21:02:28.979 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:02:28.990 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:02:29.000 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:02:29.011 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:02:29.019 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 21:02:29.029 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 21:02:29.037 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 260.0, Amount: 5.0, New Balance: 265.0
2025-09-05 21:02:29.050 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 265.0, Amount: 5.0, New Balance: 270.0
2025-09-05 21:02:29.212 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 21:02:29.260 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:02:29.270 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:02:29.281 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:02:29.293 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:02:29.302 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 21:02:29.313 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 21:02:29.323 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:02:29.338 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:02:29.351 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 21:02:29.363 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 21:02:29.376 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:02:29.411 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:02:29.436 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:02:29.468 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 21:02:29.502 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 21:02:29.515 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 21:02:29.525 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 21:02:29.534 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1017.0, Amount: 1.0, New Balance: 1018.0
2025-09-05 21:02:29.546 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1018.0, Amount: 1.0, New Balance: 1019.0
2025-09-05 21:02:29.554 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1019.0, Amount: 1.0, New Balance: 1020.0
2025-09-05 21:02:29.615 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:02:29.670 [pool-6-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 10.0, New Balance: 510.0
2025-09-05 21:02:29.698 [pool-6-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 510.0, Amount: 10.0, New Balance: 520.0
2025-09-05 21:02:29.736 [pool-6-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 21:02:29.766 [pool-6-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 520.0, Amount: 10.0, New Balance: 530.0
2025-09-05 21:02:29.798 [pool-6-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 530.0, Amount: 10.0, New Balance: 540.0
2025-09-05 21:02:29.850 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:02:30.063 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:02:30.089 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:02:30.105 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:02:30.148 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:02:30.172 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:02:30.230 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:02:30.345 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:02:30.359 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:02:30.369 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:02:30.572 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:02:30.587 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:02:30.629 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:02:30.675 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:02:30.685 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: d393fd63-cf4c-49a2-ab18-da2d655ce49b
2025-09-05 21:02:30.922 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:02:30.952 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:02:30.974 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:02:30.984 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:02:30.994 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:02:31.160 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:02:31.170 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:02:31.178 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:02:31.243 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:02:31.254 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:02:31.261 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:02:31.276 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:02:31.361 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:02:31.371 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:02:31.393 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:02:31.402 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:02:31.404 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:02:32.327 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:02:32.348 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:02:32.378 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:02:32.392 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:02:32.398 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:02:32.704 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:02:32.716 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:02:32.722 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:02:32.869 [pool-7-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:02:32.903 [pool-7-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:02:32.916 [pool-7-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A007
2025-09-05 21:02:32.919 [pool-7-thread-3] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 21:02:32.920 [pool-7-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 21:02:32.940 [pool-7-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -100.0, New Balance: 900.0
2025-09-05 21:02:32.947 [pool-7-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: -50.0, New Balance: 450.0
2025-09-05 21:02:32.949 [pool-7-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -200.0, New Balance: 800.0
2025-09-05 21:02:32.957 [pool-7-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 100.0, New Balance: 600.0
2025-09-05 21:02:32.960 [pool-7-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T003
2025-09-05 21:02:32.964 [pool-7-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: 50.0, New Balance: 1050.0
2025-09-05 21:02:32.967 [pool-7-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T005
2025-09-05 21:02:32.990 [pool-7-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 40001, SQLState: 40001
2025-09-05 21:02:32.990 [pool-7-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Deadlock detected. The current transaction was rolled back. Details: "ACCOUNTS"; SQL statement:
update accounts set account_number=?,balance=? where id=? [40001-224]
2025-09-05 21:02:33.054 [pool-7-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 300.0, Amount: 200.0, New Balance: 500.0
2025-09-05 21:02:33.072 [pool-7-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T004
2025-09-05 21:02:33.195 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:02:33.253 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:02:33.412 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:02:33.462 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:02:33.469 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:02:33.512 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:02:33.829 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:02:33.888 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:02:33.917 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:02:33.954 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:02:33.963 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:02:34.216 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:02:34.250 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:02:34.304 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:02:34.344 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:02:34.353 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:02:34.396 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:02:34.490 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:02:34.579 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:02:34.595 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:02:34.605 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:02:34.756 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:02:34.768 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:02:34.776 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:02:36.078 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:02:36.087 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:02:36.090 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:10:38.257 [main] WARN  c.s.b.service.TransactionService - Failed to acquire lock for transaction: TX001
2025-09-05 21:10:38.368 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: ACC001, balance: 50.0, amount: 100.0
2025-09-05 21:10:38.412 [main] WARN  c.s.b.service.TransactionService - Failed to acquire lock for transaction: TX001
2025-09-05 21:10:38.503 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: TX001
2025-09-05 21:10:38.621 [main] WARN  c.s.b.service.TransactionService - Source account not found: ACC001
2025-09-05 21:10:38.655 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: 62294a78-46c4-4e21-9588-1b8be8ad190c
2025-09-05 21:10:38.705 [main] WARN  c.s.b.service.TransactionService - Failed to acquire lock for transaction: TX001
2025-09-05 21:10:38.827 [pool-1-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: TX0
2025-09-05 21:10:38.841 [pool-1-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: TX1
2025-09-05 21:10:38.842 [pool-1-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: TX2
2025-09-05 21:10:38.850 [pool-1-thread-4] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: TX3
2025-09-05 21:10:38.854 [pool-1-thread-5] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: TX4
2025-09-05 21:10:38.880 [main] ERROR c.s.b.service.TransactionService - Transaction update failed. Rolling back changes. Transaction ID: TX001
2025-09-05 21:12:06.613 [main] INFO  c.s.b.service.AccountServiceTest - Starting AccountServiceTest using Java 17.0.16 with PID 56143 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:12:06.619 [main] DEBUG c.s.b.service.AccountServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:12:06.621 [main] INFO  c.s.b.service.AccountServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:12:09.078 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:12:09.081 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:12:09.439 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 342 ms. Found 2 JPA repository interfaces.
2025-09-05 21:12:09.486 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:12:09.489 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:12:09.525 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:12:09.526 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:12:09.527 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 0 Redis repository interfaces.
2025-09-05 21:12:13.132 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:12:13.240 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:12:13.315 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:12:13.829 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:12:13.867 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:12:14.252 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:12:14.254 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:12:14.297 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:12:14.308 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:12:15.810 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:12:15.879 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:12:18.250 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:12:20.677 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:12:20.841 [main] INFO  c.s.b.service.AccountServiceTest - Started AccountServiceTest in 14.666 seconds (process running for 18.251)
2025-09-05 21:12:20.851 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:12:21.859 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: T001
2025-09-05 21:12:21.859 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:12:22.469 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 21:12:22.757 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 21:12:23.049 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:12:23.087 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 21:12:23.278 [pool-3-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:12:23.290 [pool-3-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:12:23.302 [pool-3-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:12:23.323 [pool-3-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 21:12:23.333 [pool-3-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:12:23.342 [pool-3-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:12:23.352 [pool-3-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:12:23.362 [pool-3-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 21:12:23.372 [pool-3-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:12:23.380 [pool-3-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:12:23.395 [pool-3-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:12:23.407 [pool-3-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 21:12:23.418 [pool-3-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 21:12:23.436 [pool-3-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 260.0, Amount: 5.0, New Balance: 265.0
2025-09-05 21:12:23.463 [pool-3-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 265.0, Amount: 5.0, New Balance: 270.0
2025-09-05 21:12:23.582 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 21:12:23.669 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:12:23.683 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:12:23.711 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:12:23.720 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:12:23.729 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 21:12:23.738 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 21:12:23.751 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:12:23.769 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:12:23.786 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 21:12:23.800 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 21:12:23.808 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:12:23.819 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:12:23.835 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:12:23.861 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 21:12:23.878 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 21:12:23.888 [pool-4-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 21:12:23.896 [pool-4-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 21:12:23.913 [pool-4-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1017.0, Amount: 1.0, New Balance: 1018.0
2025-09-05 21:12:23.936 [pool-4-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1018.0, Amount: 1.0, New Balance: 1019.0
2025-09-05 21:12:23.953 [pool-4-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1019.0, Amount: 1.0, New Balance: 1020.0
2025-09-05 21:12:24.024 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:12:24.111 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:12:24.335 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:12:24.344 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:12:24.350 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:13:04.933 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 56207 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:13:04.935 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:13:04.939 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:13:07.455 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:13:07.458 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:13:07.784 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 313 ms. Found 2 JPA repository interfaces.
2025-09-05 21:13:07.817 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:13:07.819 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:13:07.848 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:13:07.848 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:13:07.849 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-09-05 21:13:11.445 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:13:11.547 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:13:11.611 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:13:12.045 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:13:12.090 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:13:12.447 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:13:12.449 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:13:12.491 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:13:12.498 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:13:13.880 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:13:13.946 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:13:16.465 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:13:18.705 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:13:18.867 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 14.671 seconds (process running for 17.852)
2025-09-05 21:13:18.883 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:13:19.849 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:13:20.138 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:13:20.306 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:13:20.503 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 21:13:20.567 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 21:13:20.583 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 21:13:20.775 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:13:20.849 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 21:13:20.849 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:13:21.113 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 21:13:21.148 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:13:21.203 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 21:13:21.204 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 21:13:21.339 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
2025-09-05 21:13:21.347 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:13:21.462 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 21:13:21.463 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:13:21.555 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:13:21.770 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:13:21.771 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:13:21.953 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:13:21.975 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:13:21.992 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:14:07.846 [main] INFO  c.s.b.service.TransactionServiceTest - Starting TransactionServiceTest using Java 17.0.16 with PID 56285 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:14:07.848 [main] DEBUG c.s.b.service.TransactionServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:14:07.849 [main] INFO  c.s.b.service.TransactionServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:14:10.360 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:14:10.364 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:14:10.780 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 383 ms. Found 2 JPA repository interfaces.
2025-09-05 21:14:10.808 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:14:10.809 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:14:10.830 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:14:10.831 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:14:10.831 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-09-05 21:14:13.190 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:14:13.279 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:14:13.330 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:14:13.984 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:14:14.059 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:14:14.948 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:14:14.951 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:14:14.996 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:14:15.008 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:14:16.838 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:14:16.941 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:14:21.132 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:14:23.772 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:14:24.018 [main] INFO  c.s.b.service.TransactionServiceTest - Started TransactionServiceTest in 17.16 seconds (process running for 20.571)
2025-09-05 21:14:24.031 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:14:24.945 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:14:25.640 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:14:25.790 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:14:25.904 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:14:26.016 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:14:26.051 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:14:26.057 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:14:26.371 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:14:26.383 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:14:26.392 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:14:26.511 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:14:26.528 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:14:26.585 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:14:26.601 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:14:26.604 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: 762d6373-ad96-4e5d-9cbe-d29b75be1de1
2025-09-05 21:14:26.765 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:14:26.786 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:14:26.824 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:14:26.836 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:14:26.840 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:14:26.906 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:14:26.919 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:14:26.932 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:14:27.065 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:14:27.091 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:14:27.111 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:14:27.149 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:14:27.308 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:14:27.320 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:14:27.337 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:14:27.354 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:14:27.357 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:14:28.248 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:14:28.271 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:14:28.302 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:14:28.317 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:14:28.323 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:14:28.671 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:14:28.684 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:14:28.708 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:14:28.868 [pool-3-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:14:28.868 [pool-3-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:14:28.870 [pool-3-thread-3] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 21:14:28.908 [pool-3-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A007
2025-09-05 21:14:28.919 [pool-3-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: -50.0, New Balance: 450.0
2025-09-05 21:14:28.919 [pool-3-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -100.0, New Balance: 900.0
2025-09-05 21:14:28.930 [pool-3-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -200.0, New Balance: 800.0
2025-09-05 21:14:28.930 [pool-3-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: 100.0, New Balance: 600.0
2025-09-05 21:14:28.933 [pool-3-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T003
2025-09-05 21:14:28.939 [pool-3-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: 50.0, New Balance: 1050.0
2025-09-05 21:14:28.943 [pool-3-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T005
2025-09-05 21:14:28.971 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 40001, SQLState: 40001
2025-09-05 21:14:28.971 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Deadlock detected. The current transaction was rolled back. Details: "ACCOUNTS"; SQL statement:
update accounts set account_number=?,balance=? where id=? [40001-224]
2025-09-05 21:14:28.979 [pool-3-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 300.0, Amount: 200.0, New Balance: 500.0
2025-09-05 21:14:28.981 [pool-3-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T004
2025-09-05 21:14:29.154 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:14:29.179 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:14:29.203 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:14:29.220 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:14:29.229 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:14:29.276 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:14:29.431 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:14:29.450 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:14:29.476 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:14:29.495 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:14:29.502 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:14:29.702 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:14:29.724 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:14:29.749 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:14:29.759 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:14:29.763 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:14:29.803 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:14:29.841 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:14:29.859 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:14:29.870 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:14:29.901 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:14:29.989 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:14:30.008 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:14:30.015 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:14:30.176 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:14:30.183 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:14:30.187 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:14:53.314 [main] INFO  c.s.b.service.TransactionServiceTest - Starting TransactionServiceTest using Java 17.0.16 with PID 56324 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:14:53.321 [main] DEBUG c.s.b.service.TransactionServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:14:53.323 [main] INFO  c.s.b.service.TransactionServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:14:55.679 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:14:55.688 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:14:56.117 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 396 ms. Found 2 JPA repository interfaces.
2025-09-05 21:14:56.239 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:14:56.255 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:14:56.341 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:14:56.342 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:14:56.343 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 45 ms. Found 0 Redis repository interfaces.
2025-09-05 21:15:00.006 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:15:00.080 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:15:00.135 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:15:00.510 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:15:00.545 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:15:00.853 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:15:00.867 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:15:01.002 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:15:01.020 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:15:02.971 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:15:03.022 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:15:05.437 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:15:07.929 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:15:08.147 [main] INFO  c.s.b.service.TransactionServiceTest - Started TransactionServiceTest in 15.47 seconds (process running for 19.325)
2025-09-05 21:15:08.160 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:15:09.262 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:15:09.684 [pool-3-thread-1] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:15:09.687 [pool-3-thread-3] DEBUG c.s.balance.service.AccountService - Finding account by account number: A006
2025-09-05 21:15:09.687 [pool-3-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:15:09.846 [pool-3-thread-2] DEBUG c.s.balance.service.AccountService - Finding account by account number: A007
2025-09-05 21:15:09.890 [pool-3-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -100.0, New Balance: 900.0
2025-09-05 21:15:09.891 [pool-3-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 500.0, Amount: -50.0, New Balance: 450.0
2025-09-05 21:15:09.899 [pool-3-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: -200.0, New Balance: 800.0
2025-09-05 21:15:09.918 [pool-3-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 300.0, Amount: 200.0, New Balance: 500.0
2025-09-05 21:15:09.918 [pool-3-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 1000.0, Amount: 50.0, New Balance: 1050.0
2025-09-05 21:15:09.922 [pool-3-thread-2] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T004
2025-09-05 21:15:09.923 [pool-3-thread-3] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T005
2025-09-05 21:15:09.952 [pool-3-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A006, Old Balance: 450.0, Amount: 100.0, New Balance: 550.0
2025-09-05 21:15:09.954 [pool-3-thread-1] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T003
2025-09-05 21:15:10.299 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:15:10.307 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:15:10.310 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:16:09.592 [main] INFO  c.s.b.service.TransactionServiceTest - Starting TransactionServiceTest using Java 17.0.16 with PID 56410 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:16:09.601 [main] DEBUG c.s.b.service.TransactionServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:16:09.604 [main] INFO  c.s.b.service.TransactionServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:16:11.473 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:16:11.475 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:16:11.709 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 217 ms. Found 2 JPA repository interfaces.
2025-09-05 21:16:11.738 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:16:11.740 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:16:11.759 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:16:11.760 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:16:11.760 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-09-05 21:16:13.812 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:16:13.883 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:16:13.930 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:16:14.274 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:16:14.305 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:16:14.615 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:16:14.617 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:16:14.650 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:16:14.656 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:16:15.767 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:16:15.820 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:16:17.932 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:16:20.845 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:16:20.989 [main] INFO  c.s.b.service.TransactionServiceTest - Started TransactionServiceTest in 11.988 seconds (process running for 14.731)
2025-09-05 21:16:21.002 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:16:21.719 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:16:22.278 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:16:22.390 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:16:22.553 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:16:22.589 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:16:22.671 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:16:22.696 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:16:23.272 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:16:23.306 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:16:23.318 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:16:23.545 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:16:23.603 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:16:23.643 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:16:23.712 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:16:23.722 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: 95d6af0f-c2a5-4fa2-bc42-7208800bcc67
2025-09-05 21:16:23.971 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:16:23.985 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:16:24.004 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:16:24.014 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:16:24.022 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:16:24.110 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:16:24.194 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:16:24.204 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:16:24.295 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:16:24.410 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:16:24.430 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:16:24.585 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:16:24.745 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:16:24.757 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:16:24.772 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:16:24.780 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:16:24.783 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:16:25.338 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:16:25.357 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:16:25.396 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:16:25.426 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:16:25.428 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:16:25.763 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:16:25.780 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:16:25.790 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:16:25.863 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:16:25.895 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:16:25.926 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:16:25.943 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:16:25.945 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:16:25.978 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:16:26.104 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:16:26.115 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:16:26.128 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:16:26.137 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:16:26.139 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:16:26.257 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:16:26.275 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:16:26.289 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:16:26.297 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:16:26.302 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:16:26.346 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:16:26.389 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:16:26.399 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:16:26.404 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:16:26.413 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:16:26.599 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:16:26.617 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:16:26.631 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:16:26.819 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:16:26.857 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:16:26.866 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:17:29.923 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 56481 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:17:29.926 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:17:29.927 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:17:33.808 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:17:33.813 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:17:34.576 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 739 ms. Found 2 JPA repository interfaces.
2025-09-05 21:17:34.614 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:17:34.621 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:17:34.656 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:17:34.657 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:17:34.657 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-05 21:17:41.433 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:17:41.789 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:17:41.977 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:17:42.826 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:17:42.906 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:17:43.797 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:17:43.811 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:17:43.902 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:17:43.936 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:17:47.855 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:17:48.009 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:17:52.423 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:17:56.185 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:17:56.554 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 27.575 seconds (process running for 33.864)
2025-09-05 21:17:56.578 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:17:58.769 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:17:59.060 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:17:59.257 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:17:59.492 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 21:17:59.648 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 21:17:59.685 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 21:17:59.845 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:17:59.880 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 21:17:59.881 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:18:00.215 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 21:18:00.247 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:18:00.305 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 21:18:00.306 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 21:18:00.459 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 21:18:00.468 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:18:00.558 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 21:18:00.558 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:18:00.733 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:18:00.900 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:18:00.901 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:18:01.958 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 21:18:02.159 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 21:18:02.460 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:18:02.495 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 21:18:02.715 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:18:02.725 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:18:02.761 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 21:18:02.806 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:18:02.843 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:18:02.874 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:18:02.885 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:18:02.893 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 21:18:02.904 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:18:02.912 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:18:02.924 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:18:02.944 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 21:18:02.968 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 21:18:02.991 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 260.0, Amount: 5.0, New Balance: 265.0
2025-09-05 21:18:03.025 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 260.0, Amount: 5.0, New Balance: 265.0
2025-09-05 21:18:03.080 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 21:18:03.144 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:18:03.242 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:18:03.308 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:18:03.324 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:18:03.338 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 21:18:03.362 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 21:18:03.397 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:18:03.433 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:18:03.478 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:18:03.489 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 21:18:03.506 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 21:18:03.525 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:18:03.568 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:18:03.575 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:18:03.594 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 21:18:03.615 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 21:18:03.674 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 21:18:03.705 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 21:18:03.719 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1017.0, Amount: 1.0, New Balance: 1018.0
2025-09-05 21:18:03.727 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1018.0, Amount: 1.0, New Balance: 1019.0
2025-09-05 21:18:03.779 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:18:03.832 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:18:04.053 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:18:04.085 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:18:04.126 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:18:04.220 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:18:04.234 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:18:04.241 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:18:04.335 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:18:04.354 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:18:04.365 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:18:04.551 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:18:04.563 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:18:04.603 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:18:04.658 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:18:04.673 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: d2895b39-9a34-4d8f-9e45-1d1700504c91
2025-09-05 21:18:04.891 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:18:04.920 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:18:04.935 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:18:04.946 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:18:04.953 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:18:05.119 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:18:05.127 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:18:05.134 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:18:05.194 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:18:05.252 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:18:05.325 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:18:05.341 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:18:05.525 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:18:05.544 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:18:05.573 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:18:05.584 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:18:05.587 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:18:06.532 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:18:06.555 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:18:06.574 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:18:06.584 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:18:06.589 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:18:06.846 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:18:06.857 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:18:06.864 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:18:06.924 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:18:06.936 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:18:06.956 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:18:07.038 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:18:07.047 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:18:07.110 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:18:07.178 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:18:07.193 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:18:07.208 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:18:07.216 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:18:07.220 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:18:07.599 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:18:07.626 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:18:07.662 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:18:07.676 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:18:07.685 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:18:07.790 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:18:07.879 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:18:07.891 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:18:07.896 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:18:07.909 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:18:08.029 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:18:08.126 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:18:08.136 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:18:09.021 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:18:09.031 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:18:09.036 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:18:59.712 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 56595 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:18:59.715 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:18:59.716 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:19:04.403 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:19:04.438 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:19:05.239 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 771 ms. Found 2 JPA repository interfaces.
2025-09-05 21:19:05.283 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:19:05.287 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:19:05.323 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:19:05.324 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:19:05.324 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
2025-09-05 21:19:08.556 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:19:08.733 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:19:08.868 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:19:09.643 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:19:09.710 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:19:10.539 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:19:10.543 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:19:10.656 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:19:10.669 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:19:13.082 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:19:13.207 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:19:16.598 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:19:20.017 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:19:20.223 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 21.735 seconds (process running for 31.745)
2025-09-05 21:19:20.262 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:19:22.061 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:19:22.212 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:19:22.309 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:19:22.444 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 21:19:22.483 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 21:19:22.487 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 21:19:22.547 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:19:22.576 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 21:19:22.577 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:19:22.815 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 21:19:22.838 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:19:22.875 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 21:19:22.875 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 21:19:22.960 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 21:19:22.967 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:19:23.069 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 21:19:23.070 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:19:23.247 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:19:23.445 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:19:23.446 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:19:24.030 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 21:19:24.246 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 21:19:24.567 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:19:24.658 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 21:19:24.893 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:19:24.903 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:19:24.912 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:19:24.932 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 21:19:24.962 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:19:24.985 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:19:25.052 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:19:25.080 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:19:25.096 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 21:19:25.108 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:19:25.118 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:19:25.130 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:19:25.147 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:19:25.166 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 21:19:25.199 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 21:19:25.317 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 21:19:25.361 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:19:25.371 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:19:25.380 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:19:25.387 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:19:25.395 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 21:19:25.401 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 21:19:25.414 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:19:25.426 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:19:25.434 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:19:25.444 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 21:19:25.462 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 21:19:25.484 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:19:25.502 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:19:25.534 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:19:25.569 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 21:19:25.583 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 21:19:25.591 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 21:19:25.599 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 21:19:25.608 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1017.0, Amount: 1.0, New Balance: 1018.0
2025-09-05 21:19:25.617 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1018.0, Amount: 1.0, New Balance: 1019.0
2025-09-05 21:19:25.661 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:19:25.713 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:19:25.948 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:19:26.045 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:19:26.083 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:19:26.104 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:19:26.120 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:19:26.127 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:19:26.220 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:19:26.238 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:19:26.249 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:19:26.430 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:19:26.442 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:19:26.460 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:19:26.471 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:19:26.481 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: f4793c35-5c3d-49ca-bcd7-e928691e89b7
2025-09-05 21:19:26.658 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:19:26.669 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:19:26.743 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:19:26.811 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:19:26.817 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:19:26.876 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:19:26.938 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:19:26.971 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:19:27.070 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:19:27.114 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:19:27.119 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:19:27.141 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:19:27.408 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:19:27.494 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:19:27.520 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:19:27.530 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:19:27.532 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:19:28.381 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:19:28.393 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:19:28.411 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:19:28.418 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:19:28.421 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:19:28.670 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:19:28.681 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:19:28.688 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:19:28.738 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:19:28.754 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:19:28.767 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:19:28.777 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:19:28.780 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:19:28.800 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:19:28.974 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:19:28.986 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:19:29.012 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:19:29.020 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:19:29.024 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:19:29.100 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:19:29.111 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:19:29.129 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:19:29.202 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:19:29.253 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:19:29.313 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:19:29.358 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:19:29.369 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:19:29.372 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:19:29.385 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:19:29.585 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:19:29.598 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:19:29.604 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:19:30.458 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:19:30.469 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:19:30.472 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:25:23.637 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 57012 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:25:23.657 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:25:23.659 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:25:27.821 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:25:27.826 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:25:28.686 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 823 ms. Found 2 JPA repository interfaces.
2025-09-05 21:25:28.729 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:25:28.732 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:25:28.780 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:25:28.781 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:25:28.781 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
2025-09-05 21:25:35.979 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:25:36.218 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:25:36.368 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:25:37.403 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:25:37.745 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:25:40.286 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:25:40.295 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:25:40.563 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:25:40.577 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:25:45.305 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:25:45.447 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:25:49.620 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:25:55.193 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:25:55.873 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 33.392 seconds (process running for 38.017)
2025-09-05 21:25:55.894 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:25:57.570 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: T001
2025-09-05 21:25:57.571 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:25:57.740 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:25:57.922 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:25:58.049 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 21:25:58.085 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 21:25:58.089 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 21:25:58.175 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:25:58.214 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 21:25:58.215 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:25:58.377 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 21:25:58.407 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:25:58.436 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 21:25:58.437 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 21:25:58.574 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 21:25:58.581 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:25:58.680 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 21:25:58.681 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:25:58.763 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:25:58.892 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:25:58.893 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:26:00.221 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 21:26:00.475 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 21:26:00.892 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:26:00.963 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 21:26:01.228 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:26:01.240 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:26:01.253 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 21:26:01.279 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:26:01.295 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:26:01.305 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:26:01.316 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:26:01.327 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:26:01.337 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 21:26:01.346 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:26:01.359 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:26:01.371 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:26:01.381 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:26:01.391 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 21:26:01.401 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 21:26:01.501 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 21:26:01.605 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:26:01.613 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:26:01.626 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:26:01.638 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:26:01.647 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:26:01.658 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:26:01.670 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 21:26:01.680 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 21:26:01.691 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:26:01.704 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:26:01.717 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:26:01.727 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 21:26:01.741 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 21:26:01.752 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:26:01.761 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:26:01.770 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:26:01.780 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 21:26:01.791 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 21:26:01.802 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 21:26:01.812 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 21:26:01.868 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:26:01.938 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:26:02.254 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:26:02.325 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:26:02.341 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:26:02.373 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:26:02.387 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:26:02.395 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:26:02.659 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:26:02.677 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:26:02.688 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:26:02.824 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:26:02.840 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:26:02.925 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:26:02.936 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:26:02.940 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: dab134f8-c2dc-4198-944e-41cb1461dd30
2025-09-05 21:26:03.163 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:26:03.180 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:26:03.204 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:26:03.215 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:26:03.272 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:26:03.335 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:26:03.358 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:26:03.375 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:26:03.460 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:26:03.493 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:26:03.499 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:26:03.522 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:26:03.649 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:26:03.662 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:26:03.684 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:26:03.702 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:26:03.705 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:26:05.088 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:26:05.100 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:26:05.136 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:26:05.150 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:26:05.154 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:26:05.367 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:26:05.383 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:26:05.400 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:26:05.501 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:26:05.517 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:26:05.547 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:26:05.559 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:26:05.563 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:26:05.600 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:26:05.732 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:26:05.746 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:26:05.775 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:26:05.792 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:26:05.797 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:26:05.928 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:26:05.944 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:26:05.980 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:26:05.997 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:26:06.005 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:26:06.065 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:26:06.117 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:26:06.129 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:26:06.137 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:26:06.159 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:26:06.296 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:26:06.331 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:26:06.339 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:26:07.528 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:26:07.541 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:26:07.546 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-05 21:32:02.251 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Starting TransactionRecoveryServiceTest using Java 17.0.16 with PID 57499 (started by wengxk in /Users/wengxk/Documents/springboot/real-time-balance-calculation)
2025-09-05 21:32:02.258 [main] DEBUG c.s.b.s.TransactionRecoveryServiceTest - Running with Spring Boot v3.2.0, Spring v6.1.1
2025-09-05 21:32:02.259 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-09-05 21:32:06.825 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:32:06.839 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-05 21:32:07.964 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1035 ms. Found 2 JPA repository interfaces.
2025-09-05 21:32:08.004 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-09-05 21:32:08.008 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-09-05 21:32:08.044 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:32:08.044 [main] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.sacred.balance.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-09-05 21:32:08.045 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-09-05 21:32:12.361 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-05 21:32:12.811 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.3.1.Final
2025-09-05 21:32:12.918 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-09-05 21:32:13.678 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-09-05 21:32:13.744 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-05 21:32:14.787 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=POSTGRES
2025-09-05 21:32:14.798 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-05 21:32:14.995 [main] WARN  org.hibernate.dialect.Dialect - HHH000511: The 2.2.0 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 11.0.0. Check the community dialects project for available legacy versions.
2025-09-05 21:32:15.014 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-09-05 21:32:17.974 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-09-05 21:32:18.099 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:32:21.781 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-05 21:32:26.146 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 1 endpoint(s) beneath base path '/actuator'
2025-09-05 21:32:26.384 [main] INFO  c.s.b.s.TransactionRecoveryServiceTest - Started TransactionRecoveryServiceTest in 26.526 seconds (process running for 33.774)
2025-09-05 21:32:26.402 [scheduling-1] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:32:27.959 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: T001
2025-09-05 21:32:27.959 [scheduling-1] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:32:28.092 [main] DEBUG c.s.b.s.TransactionRecoveryService - No transaction keys found for recovery
2025-09-05 21:32:28.201 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:32:28.349 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_001
2025-09-05 21:32:28.384 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_TIME_001
2025-09-05 21:32:28.388 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 2 stale transactions
2025-09-05 21:32:28.473 [main] DEBUG c.s.b.s.TransactionRecoveryService - Starting periodic transaction recovery process
2025-09-05 21:32:28.498 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_PERIODIC_001
2025-09-05 21:32:28.498 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:32:28.650 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_003
2025-09-05 21:32:28.712 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:32:28.742 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_002
2025-09-05 21:32:28.743 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 3 stale transactions
2025-09-05 21:32:28.842 [main] WARN  c.s.b.s.TransactionRecoveryService - Error parsing start time for key: transaction:idempotent:INVALID_TIME_TX_001
java.time.format.DateTimeParseException: Text 'invalid-time-format' could not be parsed at index 0
	at java.base/java.time.format.DateTimeFormatter.parseResolved0(DateTimeFormatter.java:2052)
	at java.base/java.time.format.DateTimeFormatter.parse(DateTimeFormatter.java:1954)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:494)
	at java.base/java.time.LocalDateTime.parse(LocalDateTime.java:479)
	at com.sacred.balance.service.TransactionRecoveryService.recoverStaleTransactions(TransactionRecoveryService.java:58)
	at com.sacred.balance.service.TransactionRecoveryServiceTest.shouldHandleInvalidStartTimeFormat(TransactionRecoveryServiceTest.java:145)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-09-05 21:32:28.848 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:32:28.901 [main] INFO  c.s.b.s.TransactionRecoveryService - Cleaned up transaction without start time: transaction:idempotent:NO_START_TIME_TX_001
2025-09-05 21:32:28.901 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:32:29.008 [main] DEBUG c.s.b.s.TransactionRecoveryService - Transaction recovery completed. No stale transactions found
2025-09-05 21:32:29.140 [main] INFO  c.s.b.s.TransactionRecoveryService - Recovered stale transaction: STALE_TX_001
2025-09-05 21:32:29.141 [main] INFO  c.s.b.s.TransactionRecoveryService - Transaction recovery completed. Recovered 1 stale transactions
2025-09-05 21:32:29.949 [main] WARN  c.s.balance.service.AccountService - Account not found for balance update: NON_EXISTENT
2025-09-05 21:32:30.148 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: NON_EXISTENT
2025-09-05 21:32:30.566 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A005
2025-09-05 21:32:30.637 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A005, Old Balance: 400.0, Amount: 100.0, New Balance: 500.0
2025-09-05 21:32:30.794 [pool-4-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 200.0, Amount: 5.0, New Balance: 205.0
2025-09-05 21:32:30.820 [pool-4-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 205.0, Amount: 5.0, New Balance: 210.0
2025-09-05 21:32:30.854 [pool-4-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 210.0, Amount: 5.0, New Balance: 215.0
2025-09-05 21:32:30.872 [pool-4-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 215.0, Amount: 5.0, New Balance: 220.0
2025-09-05 21:32:30.894 [pool-4-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 220.0, Amount: 5.0, New Balance: 225.0
2025-09-05 21:32:30.921 [pool-4-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:32:30.937 [pool-4-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 225.0, Amount: 5.0, New Balance: 230.0
2025-09-05 21:32:30.952 [pool-4-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 230.0, Amount: 5.0, New Balance: 235.0
2025-09-05 21:32:30.966 [pool-4-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 235.0, Amount: 5.0, New Balance: 240.0
2025-09-05 21:32:30.980 [pool-4-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:32:30.996 [pool-4-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 240.0, Amount: 5.0, New Balance: 245.0
2025-09-05 21:32:31.008 [pool-4-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 245.0, Amount: 5.0, New Balance: 250.0
2025-09-05 21:32:31.022 [pool-4-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: 5.0, New Balance: 255.0
2025-09-05 21:32:31.035 [pool-4-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 255.0, Amount: 5.0, New Balance: 260.0
2025-09-05 21:32:31.048 [pool-4-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 260.0, Amount: 5.0, New Balance: 265.0
2025-09-05 21:32:31.153 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 200.0, Amount: 50.0, New Balance: 250.0
2025-09-05 21:32:31.254 [pool-5-thread-1] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1000.0, Amount: 1.0, New Balance: 1001.0
2025-09-05 21:32:31.264 [pool-5-thread-2] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1001.0, Amount: 1.0, New Balance: 1002.0
2025-09-05 21:32:31.279 [pool-5-thread-3] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:32:31.290 [pool-5-thread-4] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1002.0, Amount: 1.0, New Balance: 1003.0
2025-09-05 21:32:31.302 [pool-5-thread-5] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1003.0, Amount: 1.0, New Balance: 1004.0
2025-09-05 21:32:31.310 [pool-5-thread-6] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1004.0, Amount: 1.0, New Balance: 1005.0
2025-09-05 21:32:31.329 [pool-5-thread-7] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1005.0, Amount: 1.0, New Balance: 1006.0
2025-09-05 21:32:31.348 [pool-5-thread-8] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:32:31.356 [pool-5-thread-9] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1006.0, Amount: 1.0, New Balance: 1007.0
2025-09-05 21:32:31.369 [pool-5-thread-10] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1007.0, Amount: 1.0, New Balance: 1008.0
2025-09-05 21:32:31.392 [pool-5-thread-11] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1008.0, Amount: 1.0, New Balance: 1009.0
2025-09-05 21:32:31.405 [pool-5-thread-12] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1009.0, Amount: 1.0, New Balance: 1010.0
2025-09-05 21:32:31.416 [pool-5-thread-13] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1010.0, Amount: 1.0, New Balance: 1011.0
2025-09-05 21:32:31.484 [pool-5-thread-14] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1011.0, Amount: 1.0, New Balance: 1012.0
2025-09-05 21:32:31.535 [pool-5-thread-17] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:32:31.550 [pool-5-thread-16] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1012.0, Amount: 1.0, New Balance: 1013.0
2025-09-05 21:32:31.559 [pool-5-thread-18] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1013.0, Amount: 1.0, New Balance: 1014.0
2025-09-05 21:32:31.569 [pool-5-thread-15] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1014.0, Amount: 1.0, New Balance: 1015.0
2025-09-05 21:32:31.582 [pool-5-thread-19] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1015.0, Amount: 1.0, New Balance: 1016.0
2025-09-05 21:32:31.593 [pool-5-thread-20] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A007, Old Balance: 1016.0, Amount: 1.0, New Balance: 1017.0
2025-09-05 21:32:31.679 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:32:31.803 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:32:31.939 [main] WARN  c.s.b.service.TransactionService - Transaction processing timeout, resetting state: T014
2025-09-05 21:32:31.986 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A016
2025-09-05 21:32:32.003 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A017
2025-09-05 21:32:32.136 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A016, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:32:32.153 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A017, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:32:32.164 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T014
2025-09-05 21:32:32.457 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:32:32.492 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:32:32.553 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A001, balance: 30.0, amount: 50.0
2025-09-05 21:32:32.858 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A018
2025-09-05 21:32:32.927 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A019
2025-09-05 21:32:32.980 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A018, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:32:33.005 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A019, Old Balance: 0.0, Amount: 30.0, New Balance: 30.0
2025-09-05 21:32:33.009 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: 1118346d-0ba8-46e3-8d0e-73ff7385e373
2025-09-05 21:32:33.364 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A008
2025-09-05 21:32:33.389 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A009
2025-09-05 21:32:33.416 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 300.0, Amount: -50.0, New Balance: 250.0
2025-09-05 21:32:33.428 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:32:33.437 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T006
2025-09-05 21:32:33.547 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 250.0, Amount: -100.0, New Balance: 150.0
2025-09-05 21:32:33.614 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 150.0, Amount: 100.0, New Balance: 250.0
2025-09-05 21:32:33.630 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T007
2025-09-05 21:32:33.790 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A008, Old Balance: 150.0, Amount: -150.0, New Balance: 0.0
2025-09-05 21:32:33.864 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A009, Old Balance: 250.0, Amount: 150.0, New Balance: 400.0
2025-09-05 21:32:33.878 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T008
2025-09-05 21:32:34.024 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 3, Failed: 0
2025-09-05 21:32:34.154 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:32:34.208 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:32:34.243 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A001, Old Balance: 100.0, Amount: -50.0, New Balance: 50.0
2025-09-05 21:32:34.255 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A002, Old Balance: 0.0, Amount: 50.0, New Balance: 50.0
2025-09-05 21:32:34.257 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T001
2025-09-05 21:32:35.527 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A012
2025-09-05 21:32:35.537 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A013
2025-09-05 21:32:35.557 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A012, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:32:35.568 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A013, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:32:35.571 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T012
2025-09-05 21:32:35.865 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:32:35.892 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:32:35.909 [main] WARN  c.s.b.service.TransactionService - Source account not found: A001
2025-09-05 21:32:36.107 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A003
2025-09-05 21:32:36.160 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A004
2025-09-05 21:32:36.210 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A003, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:32:36.223 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A004, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:32:36.225 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T002
2025-09-05 21:32:36.249 [main] INFO  c.s.b.service.TransactionService - Transaction already processed: T002
2025-09-05 21:32:36.424 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A014
2025-09-05 21:32:36.439 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A015
2025-09-05 21:32:36.456 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A014, Old Balance: 200.0, Amount: -50.0, New Balance: 150.0
2025-09-05 21:32:36.467 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A015, Old Balance: 100.0, Amount: 50.0, New Balance: 150.0
2025-09-05 21:32:36.469 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T013
2025-09-05 21:32:36.642 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A010
2025-09-05 21:32:36.658 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A011
2025-09-05 21:32:36.684 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 100.0, Amount: -30.0, New Balance: 70.0
2025-09-05 21:32:36.694 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 50.0, Amount: 30.0, New Balance: 80.0
2025-09-05 21:32:36.701 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T009
2025-09-05 21:32:36.880 [main] WARN  c.s.b.service.TransactionService - Insufficient balance for account: A010, balance: 70.0, amount: 80.0
2025-09-05 21:32:37.006 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A010, Old Balance: 70.0, Amount: -20.0, New Balance: 50.0
2025-09-05 21:32:37.069 [main] INFO  c.s.balance.service.AccountService - Account balance updated. Account: A011, Old Balance: 80.0, Amount: 20.0, New Balance: 100.0
2025-09-05 21:32:37.088 [main] INFO  c.s.b.service.TransactionService - Transaction processed successfully. Transaction ID: T011
2025-09-05 21:32:37.130 [main] INFO  c.s.b.service.TransactionService - Batch processing completed. Total: 3, Success: 2, Failed: 1
2025-09-05 21:32:37.194 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A001
2025-09-05 21:32:37.207 [main] DEBUG c.s.balance.service.AccountService - Finding account by account number: A002
2025-09-05 21:32:37.219 [main] WARN  c.s.b.service.TransactionService - Destination account not found: A002
2025-09-05 21:32:38.135 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-05 21:32:38.146 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-05 21:32:38.150 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
